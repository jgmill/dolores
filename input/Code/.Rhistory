source('/Users/claudiaguenther/Documents/dolores/input/Code/R/ninja_automator.r')
neededPackages = c("dplyr", "tidyr", "psych", "cluster", "distances",
"ecodist", "magrittr", "lattice", "MASS", "foreign",
"NbClust", "factoextra", "caret", "ggplot2", "curl")
allPackages    = c(neededPackages %in% installed.packages()[,"Package"])
if (!all(allPackages)) {
missingIDX = which(allPackages == FALSE)
needed     = neededPackages[missingIDX]
lapply(needed, install.packages)
}
lapply(neededPackages, function(x) suppressPackageStartupMessages(
library(x, character.only = TRUE)))
token = 'efde8da5c66ef97b495ddddf01ef55da4c8a04e6'
h = new_handle()
handle_setheaders(h, 'Authorization'=paste('Token ', token))
dat.coordinates <- read.csv("/Users/claudiaguenther/Documents/dolores/input/Geodata/coordinates.csv")
lat = dat.coordinates$lat
lon = dat.coordinates$lon
no.obs = length(lat)
turbine = rep('Vestas+V80+2000', no.obs)
dat.germany.ts = ninja_aggregate_wind(lat, lon, turbine=turbine) # year is define in source file
dat.germany.wind = rbind(
c(NA,as.character(dat.coordinates$lat)),
c(NA,as.character(dat.coordinates$lon)),
dat.germany.ts)
dat.germany.wind.ts = dat.germany.wind
availability.vec    <- apply(dat.germany.wind.ts[,2:ncol(dat.germany.ts)], 2, mean)
View(dat.germany.wind.ts)
availability.vec    <- apply(dat.germany.wind.ts[3:nrow(dat.germany.wind.ts),2:ncol(dat.germany.wind.ts)], 2, mean)
View(dat.germany.wind.ts)
availability.vec    <- apply(dat.germany.wind.ts[3:nrow(dat.germany.wind.ts),2:ncol(dat.germany.wind.ts)], 2, mean)
availability.vec
dat.germany.wind    = rbind(
c(NA,as.character(dat.coordinates$lat)),
c(NA,as.character(dat.coordinates$lon)),
dat.germany.wind.ts)
availability.vec    <- apply(dat.germany.wind[3:nrow(dat.germany.wind.ts),2:ncol(dat.germany.wind)], 2, mean)
View(dat.germany.wind)
dat.germany.wind = dat.germany.wind.ts
availability.vec    <- apply(dat.germany.wind[3:nrow(dat.germany.wind.ts),2:ncol(dat.germany.wind)], 2, mean)
availability.vec    <- apply(dat.germany.wind[3:nrow(dat.germany.wind.ts),2:ncol(dat.germany.wind)], 2, as.numeric)
availability.vec    <- apply(availability.vec, 2, mean)
availability.vec
View(dat.germany.wind)
availability.vec
availability.wind   <- data.frame(cbind(availability.vec, t(dat.germany.wind.ts[1:2,])))
f = t(dat.germany.wind.ts[1:2,])
View(f)
availability.wind   <- data.frame(cbind(availability.vec, t(dat.germany.wind.ts[1:2,-1])))
View(availability.wind)
availability.wind   <- as.numeric(availability.wind)
View(availability.wind)
availability.wind   <- apply(availability.wind, 2, as.numeric)
availability.wind   <- data.frame(cbind(availability.vec, t(dat.germany.wind.ts[1:2,-1])))
availability.wind   <- apply(availability.wind, 2, as.numeric)
View(availability.wind)
availability.wind   <- cbind(availability.vec, t(dat.germany.wind.ts[1:2,-1]))
availability.wind   <- data.frame(apply(availability.wind, 2, as.numeric))
View(availability.wind)
ggplot(availability.wind + geom_point(aes(x=X1, y=X2, colour=as.factor(availability.vec))))
ggplot(availability.wind + geom_point(aes(x=X1, y=X2, colour=as.factor(availability.vec))))
View(availability.wind)
ggplot(availability.wind + geom_point(aes(x=X1, y=X2, colour=as.factor(availability.vec))))
View(availability.wind)
ggplot(availability.wind + geom_point(aes(x=availability.wind$X1, y=availability.wind$X2, colour=as.factor(availability.vec))))
as.factor(availability.vec)
ggplot(availability.wind + geom_point(aes(x=X1, y=X2, colour=availability.vec)))
View(availability.wind)
ggplot(availability.wind + geom_point(aes(x=X1, y=X2, colour=availability.vec)))
ggplot(availability.wind
+ geom_point(aes(x=X1, y=X2, colour=availability.vec)))
ggplot(availability.wind
+ geom_point(aes(x=X1, y=X2)))
ggplot(availability.wind
+ geom_point(aes(x=X1, y=X2)))
availability.vec    <- apply(dat.germany.wind[3:nrow(dat.germany.wind.ts),2:ncol(dat.germany.wind)], 2, as.numeric)
availability.vec    <- apply(availability.vec, 2, mean)
availability.wind   <- cbind(availability.vec, t(dat.germany.wind.ts[1:2,-1]))
availability.wind   <- as.data.frame(apply(availability.wind, 2, as.numeric))
ggplot(availability.wind
+ geom_point(aes(x=X1, y=X2, colour=availability.vec)))
View(availability.wind)
ggplot(availability.wind
+ geom_point(aes(x=1, y=2, colour=availability.vec)))
availability.vec    <- apply(dat.germany.wind[3:nrow(dat.germany.wind.ts),2:ncol(dat.germany.wind)], 2, as.numeric)
availability.vec    <- apply(availability.vec, 2, mean)
availability.wind   <- t(dat.germany.wind.ts[1:2,-1])
availability.wind   <- as.data.frame(apply(availability.wind, 2, as.numeric))
View(availability.wind)
ggplot(availability.wind
+ geom_point(aes(x=1, y=2, colour=availability.vec)))
availability.wind   <- cbind(availability.vec, availability.wind)
ggplot(availability.wind
+ geom_point(aes(x=1, y=2, colour=availability.vec)))
availability.vec    <- apply(dat.germany.wind[3:nrow(dat.germany.wind.ts),2:ncol(dat.germany.wind)], 2, as.numeric)
availability.vec    <- apply(availability.vec, 2, mean)
availability.wind   <- apply(t(dat.germany.wind.ts[1:2,-1]), 2, as.numeric)
availability.wind   <- as.data.frame(cbind(availability.vec, availability.wind))
View(availability.wind)
ggplot(availability.wind
+ geom_point(aes(x=1, y=2, colour=availability.vec)))
colnames(availability.wind) <- c("avail", "lat", "lon")
ggplot(availability.wind
+ geom_point(aes(x=lon, y=lat, colour=availability.vec)))
ggplot(availability.wind
+ geom_point(aes(x=lon, y=lat, colour=availability.vec)))
View(dat.germany.wind)
write.csv(dat.germany.wind, file = "/Users/claudiaguenther/Documents/dolores/input/timeseries_germany_wind_14.csv")
ggplot(availability.wind
+ geom_point(aes(x=lon, y=lat, colour=availability.vec)))
rm(list = ls())
dat.germany = read.csv("/Users/claudiaguenther/Documents/dolores/input/timeseries_germany_wind.csv")
dat.germany = read.csv("/Users/claudiaguenther/Documents/dolores/input/timeseries_germany_wind_14.csv")
neededPackages = c("dplyr", "tidyr", "psych", "cluster", "distances",
"ecodist", "magrittr", "lattice", "MASS", "GGally",
"NbClust", "factoextra", "caret", "ggplot2")
allPackages    = c(neededPackages %in% installed.packages()[,"Package"])
if (!all(allPackages)) {
missingIDX = which(allPackages == FALSE)
needed     = neededPackages[missingIDX]
lapply(needed, install.packages)
}
lapply(neededPackages, function(x) suppressPackageStartupMessages(
library(x, character.only = TRUE)))
dat.germany.tre           = as.data.frame(t(dat.germany))
colnames(dat.germany.tre) = unlist(dat.germany.tr[2,])
colnames(dat.germany.tre)[1:2] = c("lat", "lon")
dat.germany.tr           = as.data.frame(apply(dat.germany.tre[-c(1:2),-c(1:2)], 2, as.numeric))
dat                      = scale(dat.germany.tr)
Dis.ecl <- dist(dat.germany.tr, method = "euclidean")
clus <- hclust(Dis.ecl, method = "ward.D2")
plot(clus)
clust.centroid = function(i, dat, clusters.IND) {
ind = (clusters.IND == i)
colMeans(dat[ind,])
}
clusters = cutree(clus, k = 6)
centroids = t(sapply(unique(clusters), clust.centroid, dat.germany.tr, clusters))
cluster.k          <-  kmeans(dat.germany.tr, centers = centroids)
cluster.center     <-  cluster.k$centers
final.centers     <- data.frame((sapply(unique(clusters),
clust.centroid,
dat.germany.tr,
cluster.k$cluster)))
final.table <- table(cluster.k$cluster, clusters) # relatively stable
final.memb  <- cluster.k$cluster
sil <- silhouette(final.memb , Dis.ecl)
plot(sil, col=1:2, border=NA)
check <- cbind(cluster = c(NA, final.memb), dat.germany.tre[-1,])
check$lat <- as.numeric(as.character(check$lat))
check$lon <- as.numeric(as.character(check$lon))
check$cluster <- as.numeric((check$cluster))
scatter.hist(check$cluster, check$lat)
scatter.hist(check$cluster, check$lon)
ggplot(check[-1,]) + geom_point(aes(x=lon, y=lat, colour=as.factor(cluster)))
typeof(check$cluster)
typeof(check$lat)
typeof(check$lon)
dat.germany.wind = read.csv("/Users/claudiaguenther/Documents/dolores/input/timeseries_germany_wind_14.csv")
dat.germany.wind    = rbind(
c(NA,as.character(dat.coordinates$lat)),
c(NA,as.character(dat.coordinates$lon)),
dat.germany.wind)
dat.coordinates <- read.csv("/Users/claudiaguenther/Documents/dolores/input/Geodata/coordinates.csv")
dat.germany.wind    = rbind(
c(NA,as.character(dat.coordinates$lat)),
c(NA,as.character(dat.coordinates$lon)),
dat.germany.wind)
View(dat.germany.wind)
dat.germany.wind = read.csv("/Users/claudiaguenther/Documents/dolores/input/timeseries_germany_wind_14.csv")
View(dat.germany.wind)
View(dat.germany.wind)
availability.vec    <- apply(dat.germany.wind[2:nrow(dat.germany.wind.ts),3:ncol(dat.germany.wind)], 2, as.numeric)
availability.vec    <- apply(dat.germany.wind[2:nrow(dat.germany.wind),3:ncol(dat.germany.wind)], 2, as.numeric)
availability.vec    <- apply(availability.vec, 2, mean)
availability.wind   <- apply(t(dat.germany.wind.ts[1:2,-1]), 2, as.numeric)
View(dat.germany.wind)
availability.vec    <- apply(dat.germany.wind[2:nrow(dat.germany.wind),3:ncol(dat.germany.wind)], 2, as.numeric)
availability.vec    <- apply(availability.vec, 2, mean)
availability.wind   <- apply(t(dat.germany.wind[1:2,-1]), 2, as.numeric)
availability.wind   <- as.data.frame(cbind(availability.vec, availability.wind))
View(availability.wind)
availability.vec    <- apply(dat.germany.wind[2:nrow(dat.germany.wind),3:ncol(dat.germany.wind)], 2, as.numeric)
availability.vec    <- apply(availability.vec, 2, mean)
View(centroids)
dat.germany.wind = read.csv("/Users/claudiaguenther/Documents/dolores/input/timeseries_germany_wind_14.csv")
availability.vec    <- apply(dat.germany.wind[2:nrow(dat.germany.wind),3:ncol(dat.germany.wind)], 2, as.numeric)
availability.vec    <- apply(availability.vec, 2, mean)
View(availability.wind)
availability.vec    <- apply(dat.germany.wind[2:nrow(dat.germany.wind),3:ncol(dat.germany.wind)], 2, as.numeric)
availability.vec    <- apply(availability.vec, 2, mean)
View(availability.wind)
View(dat.germany.wind)
availability.wind   <- as.data.frame(cbind(availability.vec, dat.germany.wind[3:nrow(dat.germany.wind),3:ncol(dat.germany.wind)]))
View(dat.germany.wind)
availability.wind   <- as.data.frame(cbind(availability.vec, t(dat.germany.wind[3:nrow(dat.germany.wind),3:ncol(dat.germany.wind)])))
colnames(availability.wind) <- c("avail", "lat", "lon")
f = t(dat.germany.wind[3:nrow(dat.germany.wind),3:ncol(dat.germany.wind)]))
f = t(dat.germany.wind[3:nrow(dat.germany.wind),3:ncol(dat.germany.wind)])))
f = t(dat.germany.wind[3:nrow(dat.germany.wind),3:ncol(dat.germany.wind)])
View(f)
View(dat.germany.wind)
availability.wind   <- as.data.frame(cbind(availability.vec, t(dat.germany.wind[1:2,3:ncol(dat.germany.wind)])))
View(availability.wind)
colnames(availability.wind) <- c("avail", "lat", "lon")
ggplot(availability.wind
+ geom_point(aes(x=lon, y=lat, colour=availability.vec)))
typeof(availability.wind$avail)
typeof(availability.wind$lat)
typeof(availability.wind$lon)
ggplot(check[-1,]) + geom_point(aes(x=lon, y=lat, colour=as.factor(cluster)))
ggplot(availability.wind
+ geom_point(aes(x=lon, y=lat, colour=availability.vec)))
ggplot(availability.wind
+ geom_point(aes(x=lon, y=lat, colour=avail)))
View(availability.wind)
View(check)
ggplot(availability.wind
+ geom_point(aes(x=lon, y=lat)))
ggplot(availability.wind
+ geom_point(aes(x=lon, y=lat, colour=avail)))
g = availability.wind
plot(g)
ggplot(availability.wind
+ geom_point(aes(x=lon, y=lat, colour=avail)))
ggplot(availability.wind
+ geom_point(aes(x=availability.wind$lon, y=availability.wind$lat, colour=avail)))
ggplot(availability.wind
+ geom_point(aes(x=availability.wind$lon, y=availability.wind$lat, colour=availability.wind$avail)))
ggplot(availability.wind
+ geom_point(aes(x=lon, y=lat, colour=avail)))
availability.wind   <- as.matrix(cbind(availability.vec, t(dat.germany.wind[1:2,3:ncol(dat.germany.wind)])))
View(availability.wind)
colnames(availability.wind) <- c("avail", "lat", "lon")
ggplot(availability.wind
+ geom_point(aes(x=lon, y=lat, colour=avail)))
View(availability.wind)
ggplot(availability.wind
+ geom_point(aes(x=lon, y=lat, colour=as.factor(avail))))
k = as.data.frame(availability.wind)
View(k)
ggplot(k
+ geom_point(aes(x=lon, y=lat, colour=as.factor(avail))))
rm(list = ls())
source('/Users/claudiaguenther/Documents/dolores/input/Code/R/ninja_automator.r')
neededPackages = c("dplyr", "tidyr", "psych", "cluster", "distances",
"ecodist", "magrittr", "lattice", "MASS", "foreign",
"NbClust", "factoextra", "caret", "ggplot2", "curl")
allPackages    = c(neededPackages %in% installed.packages()[,"Package"])
if (!all(allPackages)) {
missingIDX = which(allPackages == FALSE)
needed     = neededPackages[missingIDX]
lapply(needed, install.packages)
}
lapply(neededPackages, function(x) suppressPackageStartupMessages(
library(x, character.only = TRUE)))
token = 'efde8da5c66ef97b495ddddf01ef55da4c8a04e6'
h = new_handle()
handle_setheaders(h, 'Authorization'=paste('Token ', token))
dat.coordinates <- read.csv("/Users/claudiaguenther/Documents/dolores/input/Geodata/coordinates.csv")
lat = dat.coordinates$lat
lon = dat.coordinates$lon
no.obs = length(lat)
turbine = rep('Vestas+V80+2000', no.obs)
dat.germany.wind = read.csv("/Users/claudiaguenther/Documents/dolores/input/timeseries_germany_wind_14.csv")
availability.vec    <- apply(dat.germany.wind[2:nrow(dat.germany.wind),3:ncol(dat.germany.wind)], 2, as.numeric)
availability.vec    <- apply(availability.vec, 2, mean)
availability.wind   <- as.matrix(cbind(availability.vec, t(dat.germany.wind[1:2,3:ncol(dat.germany.wind)])))
colnames(availability.wind) <- c("avail", "lati", "long")
ggplot(availability.wind
+ geom_point(aes(x=long, y=lati, colour=as.factor(avail))))
colnames(availability.wind) <- c("avail", "lati", "long")
ggplot(availability.wind
+ geom_point(aes(x=long, y=lati, colour=as.factor(avail))))
availability.wind   <- as.data.frame(cbind(availability.vec, t(dat.germany.wind[1:2,3:ncol(dat.germany.wind)])))
colnames(availability.wind) <- c("avail", "lati", "long")
ggplot(availability.wind
+ geom_point(aes(x=long, y=lati, colour=as.factor(avail))))
plot(availability.wind[,1:2])
View(availability.wind)
